From 76885f660f6fd82d27dbf14e162456f3eb819524 Mon Sep 17 00:00:00 2001
From: Roman Alexander <romanalexander@users.noreply.github.com>
Date: Thu, 16 Apr 2015 22:54:30 -0400
Subject: [PATCH] NBT exploit fix.


diff --git a/src/main/java/net/minecraft/server/PacketDataSerializer.java b/src/main/java/net/minecraft/server/PacketDataSerializer.java
index 451f5fd..a621739 100644
--- a/src/main/java/net/minecraft/server/PacketDataSerializer.java
+++ b/src/main/java/net/minecraft/server/PacketDataSerializer.java
@@ -150,7 +150,7 @@ public class PacketDataSerializer extends ByteBuf {
                 return null;
             }
             readerIndex(index);
-            return NBTCompressedStreamTools.a( new DataInputStream( new ByteBufInputStream( a ) ) );
+            return NBTCompressedStreamTools.a( new DataInputStream( new ByteBufInputStream( a ) ), new NBTReadLimiter( 2097152L ) );
         }
     }
     // Spigot end
-- 
1.9.5.msysgit.0

